import{_ as w}from"./index.6b9b62c4.js";import{b as F}from"./index.f730c59d.js";import{_ as E}from"./base-form.vue_vue_type_script_setup_true_lang.c31353a7.js";import{bE as W,n as h,u as t,ag as N,bF as T,bG as O,a1 as R,d as A,aB as I,o as $,f as z,b as l,w as i,N as _,k as D}from"./.pnpm.b1628590.js";import{F as x}from"./componentEnum.5f52cc03.js";import"./base-select.vue_vue_type_script_lang.61c5946e.js";import"./base-input-number.e6272b0b.js";import"./base-icon-picker.vue_vue_type_style_index_0_lang.89d6acdc.js";const M=Symbol("watermark-dom"),B=(m=h(document.body))=>{const C=O(function(){const e=t(m);if(!e)return;const{clientHeight:o,clientWidth:r}=e;Object.assign(n.value,{width:r,height:o}),f()},200),c=M.toString(),a=W(),n=h({}),d=()=>{const e=t(a);a.value=void 0;const o=t(m);!o||e&&o.removeChild(e)};function k(){const e=document.createElement("canvas"),o=t(n).step||1,r=t(n).value||"\u7F3A\u5C11\u6C34\u5370\u503C",s=t(n).color||"rgba(0,0,0,0.25)",p=t(n).size||"15px",g=200*o,b=140*o;Object.assign(e,{width:g,height:b});const u=e.getContext("2d");return u&&(u.rotate(-20*Math.PI/120),u.font=p+" Vedana",u.fillStyle=s,u.textAlign="left",u.textBaseline="middle",u.fillText(r,g/20,b)),e.toDataURL("image/png")}function f(){const e=t(a),o=t(n).value||"\u7F3A\u5C11\u6C34\u5370\u503C";!e||(t(n).width&&(e.style.width=`${t(n).width}px`),t(n).height&&(e.style.height=`${t(n).height}px`),o&&(e.style.background=`url(${k()}) left top repeat`))}const v=()=>{if(t(a))return f(),c;const e=document.createElement("div");a.value=e,e.id=c,e.style.pointerEvents="none",e.style.top="0px",e.style.left="0px",e.style.position="absolute",e.style.zIndex="100000";const o=t(m);if(!o)return c;const{clientHeight:r,clientWidth:s}=o;return Object.assign(n.value,{width:s,height:r}),f(),o.appendChild(e),c};function y(e){n.value=e,v(),N(m,C),R()&&T(()=>{d()})}return{setWatermark:y,clear:d}},S={class:"page-func-watermark"},J=A({__name:"index",setup(m){const C=h([{fieldName:"value",fieldDesc:"\u6C34\u5370\u540D\u5B57",fieldType:x.INPUT},{fieldName:"color",fieldDesc:"\u6C34\u5370\u989C\u8272",fieldType:x.COLOR}]),c=h(),a=I({}),{setWatermark:n,clear:d}=B(),{setWatermark:k,clear:f}=B(c),v=()=>{n({value:a.value,color:a.color})},y=()=>{k({value:a.value,color:a.color})};return(e,o)=>{const r=E,s=F,p=w;return $(),z("div",S,[l(p,{title:"\u9875\u9762\u6C34\u5370"},{default:i(()=>[l(r,{columns:C.value,model:a,inline:"",colProps:{span:8}},null,8,["columns","model"]),l(s,{type:"primary",onClick:v},{default:i(()=>[_("\u521B\u5EFA\u6C34\u5370")]),_:1}),l(s,{type:"primary",onClick:t(d)},{default:i(()=>[_("\u6E05\u9664\u6C34\u5370")]),_:1},8,["onClick"])]),_:1}),l(p,{title:"\u5BB9\u5668\u6C34\u5370"},{default:i(()=>[D("div",{style:{height:"400px"},ref_key:"boxRef",ref:c},[l(s,{type:"primary",onClick:y},{default:i(()=>[_("\u521B\u5EFA\u6C34\u5370")]),_:1}),l(s,{type:"primary",onClick:t(f)},{default:i(()=>[_("\u6E05\u9664\u6C34\u5370")]),_:1},8,["onClick"])],512)]),_:1})])}}});export{J as default};
