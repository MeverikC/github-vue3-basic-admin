import{_ as V}from"./index.6b9b62c4.js";import{d as N,aB as W,n as B,aQ as j,bD as E,c as P,Y as I,o as g,f as h,V as O,F as D,z as A,I as F,_ as M,u as Y,y as v,x as y,b as T,w as X,v as Q,k as q}from"./.pnpm.b1628590.js";import"./index.f730c59d.js";const G=["onMousedown"],J={key:1,class:"vue-drag-info"},K={key:0},U={key:1},Z=N({__name:"base-drag-resize",props:{w:{type:Number,default:200},h:{type:Number,default:200},x:{type:Number,default:0},y:{type:Number,default:0},zIndex:{type:[Number,String],default:10},sticks:{type:Array,default:()=>["tl","tm","tr","ml","mr","bl","bm","br"]},stickSize:{type:Number,default:8},isResizable:{type:Boolean,default:!0},isDraggable:{type:Boolean,default:!0},isActive:{type:Boolean,default:!1},minWidth:{type:Number,default:50},minHeight:{type:Number,default:50}},emits:["resized","update:w","update:h","update:x","update:y","resizing","draged","draging"],setup(x,{emit:s}){const i=x,w={x:{l:"left",m:"marginLeft",r:"right"},y:{t:"top",m:"marginTop",b:"bottom"}},e=W({draging:!1,resizing:!1,active:!1,boxStyle:{top:"",left:"",width:"",height:""},currentStick:null,beforeMove:{left:null,top:null,width:null,height:null,oldPageX:null,oldPageY:null}}),k=B();j(()=>{E(document,"mousedown",R)});const b=P(()=>{const{zIndex:a}=i,{top:o,left:t,width:n,height:r}=e.boxStyle;return{left:t+"px",top:o+"px",width:n+"px",height:r+"px",zIndex:a}}),m=P(()=>{const{stickSize:a}=i;return o=>{const t={width:a+"px",height:a+"px"};return t[w.y[o[0]]]=-a/2+"px",t[w.x[o[1]]]=-a/2+"px",t}}),R=()=>{e.active=!1};function C(a,o){o.stopPropagation(),e.currentStick=a;const{pageX:t,pageY:n}=o;e.resizing=!0,z({oldPageX:t,oldPageY:n}),document.onmousemove=r=>$(r),document.onmouseup=async()=>{document.onmousemove=null,document.onmouseup=null,e.currentStick=null,s("resized",e.boxStyle),e.beforeMove={left:null,top:null,width:null,height:null,oldPageX:null,oldPageY:null},e.resizing=!1}}function z(a){const{left:o,top:t,height:n,width:r}=e.boxStyle;e.beforeMove={left:o,top:t,height:n,width:r,...a}}function $(a){const{pageX:o,pageY:t}=a,{top:n,left:r,height:u,width:d,oldPageX:l,oldPageY:c}=e.beforeMove;let p=u,f=d,_=n,S=r;switch(e.currentStick){case"tl":_=t-c+n,S=o-l+r,p=c-t+u,f=l-o+d;break;case"tm":p=c-t+u,_=t-c+n;break;case"tr":_=t-c+n,p=c-t+u,f=o-l+d;break;case"ml":S=o-l+r,f=l-o+d;break;case"mr":f=o-l+d;break;case"bl":S=o-l+r,f=l-o+d,p=t-c+u;break;case"bm":p=t-c+u;break;case"br":p=t-c+u,f=o-l+d;break}f>=i.minWidth&&(e.boxStyle.left=S,e.boxStyle.width=f,s("update:w",e.boxStyle.width),s("update:x",e.boxStyle.left)),p>=i.minHeight&&(e.boxStyle.top=_,e.boxStyle.height=p,s("update:h",e.boxStyle.height),s("update:y",e.boxStyle.top)),s("resizing",{width:e.boxStyle.width,height:e.boxStyle.height,left:e.boxStyle.left,top:e.boxStyle.top})}function H(a){if(e.active=!0,a.stopPropagation(),!i.isDraggable)return;const{pageX:o,pageY:t}=a;z({oldPageX:o,oldPageY:t}),e.draging=!0,document.onmousemove=n=>L(n),document.onmouseup=async()=>{document.onmousemove=null,document.onmouseup=null,s("draged",{left:e.boxStyle.left,top:e.boxStyle.top}),e.beforeMove={left:null,top:null,width:null,height:null,oldPageX:null,oldPageY:null},e.draging=!1}}async function L(a){const{pageX:o,pageY:t}=a,{top:n,left:r,oldPageX:u,oldPageY:d}=e.beforeMove,l={left:o-u+r,top:t-d+n};Object.assign(e.boxStyle,l),s("update:x",l.left),s("update:y",l.top),s("draging",l)}return I(()=>{e.active=i.isActive,e.boxStyle.left=i.x,e.boxStyle.top=i.y,e.boxStyle.height=i.h,e.boxStyle.width=i.w}),(a,o)=>(g(),h("div",{class:F(["base-drag-reisze",{active:e.active,"vue-drag-moving":e.draging,"vue-drag-resizing":e.resizing}]),ref_key:"baseDragRef",ref:k,style:M(Y(b)),onMousedown:o[0]||(o[0]=t=>H(t))},[O(a.$slots,"default"),e.active&&x.isResizable?(g(!0),h(D,{key:0},A(x.sticks,t=>(g(),h("div",{key:t,class:F(["vue-drag-stick",`vue-drag-stick-${t}`]),style:M(Y(m)(t)),onMousedown:n=>C(t,n)},null,46,G))),128)):v("",!0),e.draging||e.resizing?(g(),h("div",J,[e.draging?(g(),h("span",K,"X\uFF1A"+y(e.boxStyle.left)+"\uFF0CY\uFF1A"+y(e.boxStyle.top),1)):v("",!0),e.resizing?(g(),h("span",U,"H\uFF1A"+y(e.boxStyle.height)+"\uFF0CW\uFF1A"+y(e.boxStyle.width),1)):v("",!0)])):v("",!0)],38))}});const ee={class:"page-func-drag-resize"},te={class:"index"},le=N({__name:"index",setup(x){const s=B([{w:150,h:150,x:0,y:0},{w:150,h:150,x:200,y:100}]);return(i,w)=>{const e=Z,k=V;return g(),h("div",ee,[T(k,{height:"600px",class:"grid"},{default:X(()=>[(g(!0),h(D,null,A(s.value,(b,m)=>(g(),Q(e,{key:m,w:b.w,h:b.h,x:b.x,y:b.y,class:"resize-item flex-center"},{default:X(()=>[q("span",te,y(m+1),1)]),_:2},1032,["w","h","x","y"]))),128))]),_:1})])}}});export{le as default};
