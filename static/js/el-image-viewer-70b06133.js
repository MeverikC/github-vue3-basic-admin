import{J as ke,bq as he,bW as R,n as fe,q as le,s as ve,z as ce,d as Q,cq as de,dI as Ie,dJ as _e,bk as me,y as pe,dK as Le,r as b,ck as Ee,bU as Ce,x as k,V as oe,a6 as ge,a1 as we,o as h,B as re,f as c,w as E,e as v,D as d,g as e,E as ie,aS as ze,ac as I,aT as S,aR as Oe,c as x,a5 as ue,bA as Se,bB as xe,dL as Te,dM as Ne,F as Ae,dN as $e,dO as Me,aO as Re,au as Ve,by as Be,C as K,ad as De,cF as Fe,G as ye,ca as V,bp as M,dP as Ye,H as be,aY as Pe,dQ as Xe,aW as He,t as We,dR as je,R as qe,dS as Ue,dT as Ze,dU as Ge}from"./index-2e4d6250.js";var Je="Expected a function";function se(f,_,r){var i=!0,m=!0;if(typeof f!="function")throw new TypeError(Je);return ke(r)&&(i="leading"in r?!!r.leading:i,m="trailing"in r?!!r.trailing:m),he(f,_,{leading:i,maxWait:_,trailing:m})}const Ke=()=>R&&/firefox/i.test(window.navigator.userAgent),Qe=fe({urlList:{type:le(Array),default:()=>ve([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0}}),ea={close:()=>!0,switch:f=>ce(f)},aa=["src"],ta=Q({name:"ElImageViewer"}),na=Q({...ta,props:Qe,emits:ea,setup(f,{expose:_,emit:r}){const i=f,m={CONTAIN:{name:"contain",icon:de(Ie)},ORIGINAL:{name:"original",icon:de(_e)}},C=Ke()?"DOMMouseScroll":"mousewheel",{t:ee}=me(),l=pe("image-viewer"),{nextZIndex:B}=Le(),p=b(),L=b([]),N=Ee(),g=b(!0),u=b(i.initialIndex),A=Ce(m.CONTAIN),o=b({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),D=k(()=>{const{urlList:a}=i;return a.length<=1}),X=k(()=>u.value===0),H=k(()=>u.value===i.urlList.length-1),F=k(()=>i.urlList[u.value]),ae=k(()=>{const{scale:a,deg:n,offsetX:s,offsetY:w,enableTransition:z}=o.value;let y=s/a,O=w/a;switch(n%360){case 90:case-270:[y,O]=[O,-y];break;case 180:case-180:[y,O]=[-y,-O];break;case 270:case-90:[y,O]=[-O,y];break}const $={transform:`scale(${a}) rotate(${n}deg) translate(${y}px, ${O}px)`,transition:z?"transform .3s":""};return A.value.name===m.CONTAIN.name&&($.maxWidth=$.maxHeight="100%"),$}),W=k(()=>ce(i.zIndex)?i.zIndex:B());function T(){ne(),r("close")}function te(){const a=se(s=>{switch(s.code){case M.esc:i.closeOnPressEscape&&T();break;case M.space:Z();break;case M.left:G();break;case M.up:t("zoomIn");break;case M.right:J();break;case M.down:t("zoomOut");break}}),n=se(s=>{(s.wheelDelta?s.wheelDelta:-s.detail)>0?t("zoomIn",{zoomRate:1.2,enableTransition:!1}):t("zoomOut",{zoomRate:1.2,enableTransition:!1})});N.run(()=>{V(document,"keydown",a),V(document,C,n)})}function ne(){N.stop()}function j(){g.value=!1}function q(a){g.value=!1,a.target.alt=ee("el.image.error")}function U(a){if(g.value||a.button!==0||!p.value)return;o.value.enableTransition=!1;const{offsetX:n,offsetY:s}=o.value,w=a.pageX,z=a.pageY,y=se($=>{o.value={...o.value,offsetX:n+$.pageX-w,offsetY:s+$.pageY-z}}),O=V(document,"mousemove",y);V(document,"mouseup",()=>{O()}),a.preventDefault()}function Y(){o.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Z(){if(g.value)return;const a=Ye(m),n=Object.values(m),s=A.value.name,z=(n.findIndex(y=>y.name===s)+1)%a.length;A.value=m[a[z]],Y()}function P(a){const n=i.urlList.length;u.value=(a+n)%n}function G(){X.value&&!i.infinite||P(u.value-1)}function J(){H.value&&!i.infinite||P(u.value+1)}function t(a,n={}){if(g.value)return;const{zoomRate:s,rotateDeg:w,enableTransition:z}={zoomRate:1.4,rotateDeg:90,enableTransition:!0,...n};switch(a){case"zoomOut":o.value.scale>.2&&(o.value.scale=Number.parseFloat((o.value.scale/s).toFixed(3)));break;case"zoomIn":o.value.scale<7&&(o.value.scale=Number.parseFloat((o.value.scale*s).toFixed(3)));break;case"clockwise":o.value.deg+=w;break;case"anticlockwise":o.value.deg-=w;break}o.value.enableTransition=z}return oe(F,()=>{ge(()=>{const a=L.value[0];a!=null&&a.complete||(g.value=!0)})}),oe(u,a=>{Y(),r("switch",a)}),we(()=>{var a,n;te(),(n=(a=p.value)==null?void 0:a.focus)==null||n.call(a)}),_({setActiveItem:P}),(a,n)=>(h(),re(Fe,{to:"body",disabled:!a.teleported},[c(De,{name:"viewer-fade",appear:""},{default:E(()=>[v("div",{ref_key:"wrapper",ref:p,tabindex:-1,class:d(e(l).e("wrapper")),style:ie({zIndex:e(W)})},[v("div",{class:d(e(l).e("mask")),onClick:n[0]||(n[0]=ze(s=>a.hideOnClickModal&&T(),["self"]))},null,2),I(" CLOSE "),v("span",{class:d([e(l).e("btn"),e(l).e("close")]),onClick:T},[c(e(S),null,{default:E(()=>[c(e(Oe))]),_:1})],2),I(" ARROW "),e(D)?I("v-if",!0):(h(),x(ue,{key:0},[v("span",{class:d([e(l).e("btn"),e(l).e("prev"),e(l).is("disabled",!a.infinite&&e(X))]),onClick:G},[c(e(S),null,{default:E(()=>[c(e(Se))]),_:1})],2),v("span",{class:d([e(l).e("btn"),e(l).e("next"),e(l).is("disabled",!a.infinite&&e(H))]),onClick:J},[c(e(S),null,{default:E(()=>[c(e(xe))]),_:1})],2)],64)),I(" ACTIONS "),v("div",{class:d([e(l).e("btn"),e(l).e("actions")])},[v("div",{class:d(e(l).e("actions__inner"))},[c(e(S),{onClick:n[1]||(n[1]=s=>t("zoomOut"))},{default:E(()=>[c(e(Te))]),_:1}),c(e(S),{onClick:n[2]||(n[2]=s=>t("zoomIn"))},{default:E(()=>[c(e(Ne))]),_:1}),v("i",{class:d(e(l).e("actions__divider"))},null,2),c(e(S),{onClick:Z},{default:E(()=>[(h(),re(Ae(e(A).icon)))]),_:1}),v("i",{class:d(e(l).e("actions__divider"))},null,2),c(e(S),{onClick:n[3]||(n[3]=s=>t("anticlockwise"))},{default:E(()=>[c(e($e))]),_:1}),c(e(S),{onClick:n[4]||(n[4]=s=>t("clockwise"))},{default:E(()=>[c(e(Me))]),_:1})],2)],2),I(" CANVAS "),v("div",{class:d(e(l).e("canvas"))},[(h(!0),x(ue,null,Re(a.urlList,(s,w)=>Ve((h(),x("img",{ref_for:!0,ref:z=>L.value[w]=z,key:s,src:s,style:ie(e(ae)),class:d(e(l).e("img")),onLoad:j,onError:q,onMousedown:U},null,46,aa)),[[Be,w===u.value]])),128))],2),K(a.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var sa=ye(na,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const la=be(sa),oa=fe({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:le([String,Object])},previewSrcList:{type:le(Array),default:()=>ve([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0}}),ra={load:f=>f instanceof Event,error:f=>f instanceof Event,switch:f=>ce(f),close:()=>!0,show:()=>!0},ia=["src","loading"],ua={key:0},ca=Q({name:"ElImage",inheritAttrs:!1}),da=Q({...ca,props:oa,emits:ra,setup(f,{emit:_}){const r=f;let i="";const{t:m}=me(),C=pe("image"),ee=Pe(),l=Xe(),B=b(),p=b(!1),L=b(!0),N=b(!1),g=b(),u=b(),A=R&&"loading"in HTMLImageElement.prototype;let o,D;const X=k(()=>ee.style),H=k(()=>{const{fit:t}=r;return R&&t?{objectFit:t}:{}}),F=k(()=>{const{previewSrcList:t}=r;return Array.isArray(t)&&t.length>0}),ae=k(()=>{const{previewSrcList:t,initialIndex:a}=r;let n=a;return a>t.length-1&&(n=0),n}),W=k(()=>r.loading==="eager"?!1:!A&&r.loading==="lazy"||r.lazy),T=()=>{!R||(L.value=!0,p.value=!1,B.value=r.src)};function te(t){L.value=!1,p.value=!1,_("load",t)}function ne(t){L.value=!1,p.value=!0,_("error",t)}function j(){Ze(g.value,u.value)&&(T(),Y())}const q=Ge(j,200);async function U(){var t;if(!R)return;await ge();const{scrollContainer:a}=r;je(a)?u.value=a:qe(a)&&a!==""?u.value=(t=document.querySelector(a))!=null?t:void 0:g.value&&(u.value=Ue(g.value)),u.value&&(o=V(u,"scroll",q),setTimeout(()=>j(),100))}function Y(){!R||!u.value||!q||(o==null||o(),u.value=void 0)}function Z(t){if(!!t.ctrlKey){if(t.deltaY<0)return t.preventDefault(),!1;if(t.deltaY>0)return t.preventDefault(),!1}}function P(){!F.value||(D=V("wheel",Z,{passive:!1}),i=document.body.style.overflow,document.body.style.overflow="hidden",N.value=!0,_("show"))}function G(){D==null||D(),document.body.style.overflow=i,N.value=!1,_("close")}function J(t){_("switch",t)}return oe(()=>r.src,()=>{W.value?(L.value=!0,p.value=!1,Y(),U()):T()}),we(()=>{W.value?U():T()}),(t,a)=>(h(),x("div",{ref_key:"container",ref:g,class:d([e(C).b(),t.$attrs.class]),style:ie(e(X))},[B.value!==void 0&&!p.value?(h(),x("img",He({key:0},e(l),{src:B.value,loading:t.loading,style:e(H),class:[e(C).e("inner"),e(F)&&e(C).e("preview"),L.value&&e(C).is("loading")],onClick:P,onLoad:te,onError:ne}),null,16,ia)):I("v-if",!0),L.value||p.value?(h(),x("div",{key:1,class:d(e(C).e("wrapper"))},[L.value?K(t.$slots,"placeholder",{key:0},()=>[v("div",{class:d(e(C).e("placeholder"))},null,2)]):p.value?K(t.$slots,"error",{key:1},()=>[v("div",{class:d(e(C).e("error"))},We(e(m)("el.image.error")),3)]):I("v-if",!0)],2)):I("v-if",!0),e(F)?(h(),x(ue,{key:2},[N.value?(h(),re(e(la),{key:0,"z-index":t.zIndex,"initial-index":e(ae),infinite:t.infinite,"url-list":t.previewSrcList,"hide-on-click-modal":t.hideOnClickModal,teleported:t.previewTeleported,"close-on-press-escape":t.closeOnPressEscape,onClose:G,onSwitch:J},{default:E(()=>[t.$slots.viewer?(h(),x("div",ua,[K(t.$slots,"viewer")])):I("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):I("v-if",!0)],64)):I("v-if",!0)],6))}});var fa=ye(da,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const ma=be(fa);export{ma as E};
