import{_ as x}from"./index-25c8f987.js";import{ei as I,d as N,r as _,b as D,x as S,o as y,B as k,w as h,f as m,g as s,a6 as A,cb as R,aX as T,a1 as M,c as v,e as L,h as P,a5 as V,i as q}from"./index-0b27933a.js";import{_ as U}from"./base-form.vue_vue_type_script_setup_true_lang-207478d9.js";import{F as r}from"./componentEnum-01401fe5.js";import{g as $,a as O,b as K}from"./dept-2709d5cd.js";import{S as b}from"./basic-2a5cf92e.js";import"./base-table-78d99eaf.js";import"./el-tag-d9678e7a.js";import"./base-select.vue_vue_type_script_lang-215a5c50.js";import"./el-tree-ce0d3ca3.js";import"./el-checkbox-0495a631.js";import"./_Uint8Array-3e45c491.js";import"./base-icon-picker.vue_vue_type_style_index_0_lang-df7bc1c3.js";import"./base-column-setting-3830f98d.js";import"./vuedraggable.umd-08c858c6.js";import"./vue.runtime.esm-bundler-6e13a110.js";import"./index-3e251655.js";import"./el-col-d5314668.js";import"./base-filter-3e13e323.js";import"./el-form-item-5aaf46a3.js";import"./base-input-number-2e1c1064.js";import"./localeData-e0944d67.js";function w(a){const l=[{fieldName:"deptName",fieldDesc:"\u90E8\u95E8\u540D\u79F0",fieldType:r.INPUT},{fieldName:"status",fieldDesc:"\u72B6\u6001",fieldType:r.SELECT,config:{options:b}}],d=[{fieldName:"deptName",fieldDesc:"\u90E8\u95E8\u540D\u79F0"},{fieldName:"parentName",fieldDesc:"\u4E0A\u7EA7\u90E8\u95E8"},{fieldName:"sort",fieldDesc:"\u6392\u5E8F"},{fieldName:"status",fieldDesc:"\u72B6\u6001",formType:"tag",type:u=>u.status===0?"danger":"",formatter:u=>I(b,u.status)},{fieldName:"createTime",fieldDesc:"\u521B\u5EFA\u65F6\u95F4",width:160},{fieldName:"remark",fieldDesc:"\u5907\u6CE8",showOverflowTooltip:!0},{fieldName:"#",fieldDesc:"\u64CD\u4F5C",formType:"operation",width:175,fixed:"right",operation:[{icon:"edit",label:"\u7F16\u8F91",callFunction:a==null?void 0:a.edit},{icon:"delete",label:"\u5220\u9664",confirm:!0,callFunction:a==null?void 0:a.delete}]}],c=[{fieldName:"deptName",fieldDesc:"\u90E8\u95E8\u540D\u79F0",fieldType:r.INPUT},{fieldName:"parentId",fieldDesc:"\u4E0A\u7EA7\u90E8\u95E8",fieldType:r.SELECT,config:{api:$,tree:!0,nodeKey:"deptId",init:!0,props:{label:"deptName",children:"children"}}},{fieldName:"sort",fieldDesc:"\u6392\u5E8F",fieldType:r.NUMBER},{fieldName:"status",fieldDesc:"\u72B6\u6001",fieldType:r.SWITCH,config:{activeValue:1,inactiveValue:0}},{fieldName:"remark",fieldDesc:"\u5907\u6CE8",fieldType:r.INPUT,config:{type:"textarea"}}];return{filterColumn:l,tableColumn:d,dialogColumn:c}}const j=N({__name:"DeptDialog",emits:["success"],setup(a,{expose:l,emit:d}){const{success:c}=T(),{dialogColumn:u}=w(),n=_(),i=_(),e=D({isEdit:!1,treeData:[],defaultProps:{children:"children",label:"menuName"},formModel:{}}),p={deptName:[{required:!0,message:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",trigger:["blur","change"]}],parentId:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u90E8\u95E8",trigger:["blur","change"]}],sort:[{required:!0,message:"\u8BF7\u8F93\u5165\u6392\u5E8F",trigger:["blur","change"]}],status:[{required:!0,message:"\u8BF7\u9009\u62E9\u72B6\u6001",trigger:["blur","change"]}]},E=S(()=>e.isEdit?"\u4FEE\u6539\u90E8\u95E8":"\u65B0\u589E\u90E8\u95E8"),g=(t={})=>{s(n).showDialog(),A(()=>{s(i).instance.resetFields(),e.isEdit=!!t.deptId||t.deptId===0,e.isEdit&&Object.assign(e.formModel,t)})},o=()=>{s(n).hideDialog()},F=async t=>{await s(i).instance.validate(async f=>{if(!!f){t(!0);try{e.isEdit||await O(e.formModel),c(e.isEdit?"\u4FEE\u6539\u6210\u529F":"\u65B0\u589E\u6210\u529F\uFF01"),d("success"),o()}finally{t(!1)}}})};return l({showDialog:g,hideDialog:o}),(t,f)=>{const C=U,B=R;return y(),k(B,{ref_key:"baseDialogRef",ref:n,width:"560px",title:s(E),onSave:F},{default:h(()=>[m(C,{ref_key:"baseFormRef",ref:i,columns:s(u),rules:p,model:e.formModel},null,8,["columns","model"])]),_:1},8,["title"])}}}),H={class:"system-department-container"},pe=N({__name:"index",setup(a){const{tableColumn:l,filterColumn:d}=w({edit:E,delete:g}),{success:c}=T(),u=D({columns:d,onSearch:e,showOpen:!1,searchInfo:{}}),n=D({columns:l,data:[],showPagination:!1,rowKey:"deptId",indexShow:!1,defaultExpandAll:!0,onRefresh:e}),i=_();M(()=>{e()});async function e(){const o=await K({...u.searchInfo});n.data=o.data}function p(){s(i).showDialog()}function E(o){s(i).showDialog(o.row)}async function g(){c("\u6A21\u62DF\u5220\u9664\u6210\u529F")}return(o,F)=>{const t=q,f=x;return y(),v(V,null,[L("div",H,[m(f,{"table-title":"\u90E8\u95E8\u5217\u8868","filter-config":u,"table-config":n},{buttons:h(()=>[m(t,{type:"primary",onClick:p},{default:h(()=>[P("\u65B0\u589E\u90E8\u95E8")]),_:1})]),_:1},8,["filter-config","table-config"])]),m(j,{ref_key:"deptDialogRef",ref:i,onSuccess:e},null,512)],64)}}});export{pe as default};
